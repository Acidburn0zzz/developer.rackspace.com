<div class="highlight"><pre><span class="c">#!/bin/bash</span>
<span class="c"># upgrade all packages</span>
<span class="nb">export </span><span class="nv">DEBIAN_FRONTEND</span><span class="o">=</span>noninteractive
apt-get update
apt-get -y upgrade

<span class="c"># install PuppetLabs repo</span>
wget http://apt.puppetlabs.com/puppetlabs-release-precise.deb
dpkg -i puppetlabs-release-precise.deb

<span class="c"># Install puppet</span>
apt-get -y install puppet
service puppet stop

<span class="c"># Remove SSL directory (will be regenerated when restarted)</span>
rm -rf /var/lib/puppet/ssl

<span class="c"># Configure Puppet to talk to our puppetmaster</span>
cat &gt;&gt; /etc/puppet/puppet.conf <span class="s">&lt;&lt;-EOF</span>
<span class="s">[agent]</span>
<span class="s">server = puppet.cloudsrvr.info</span>
<span class="s">EOF</span>

<span class="c"># Start the puppet service</span>
cat &gt; /etc/default/puppet <span class="s">&lt;&lt;-EOF</span>
<span class="s"># Defaults for puppet - sourced by /etc/init.d/puppet</span>
<span class="s"># Start puppet on boot?</span>
<span class="s">START=yes</span>
<span class="s"># Startup options</span>
<span class="s">DAEMON_OPTS=&quot;&quot;</span>
<span class="s">EOF</span>
service puppet start

<span class="c"># Clean up</span>
<span class="nb">export </span><span class="nv">DEBIAN_FRONTEND</span><span class="o">=</span>dialog
</pre></div>